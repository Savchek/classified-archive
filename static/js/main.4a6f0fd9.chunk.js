(this["webpackJsonpdrag-n-drop-test"]=this["webpackJsonpdrag-n-drop-test"]||[]).push([[0],{23:function(e,t,n){e.exports=n(38)},28:function(e,t,n){},29:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),o=n.n(i),c=(n(28),n(29),n(3)),l=n(1),u=function(){return Math.random().toString(36).substr(2,9)},s=["cover","contain","auto"],d=l.m.box("loading"),p=function(e){return d.set(e)},h=Object(l.m)({1337:{id:"1337",name:"Car",layout:{13370:{id:"13370",type:"templateName",name:"Car",size:{width:"35px",height:"25px"},pos:{x:300,y:50},zIndex:1},13371:{id:"13371",type:"label",name:"Mark",size:{width:"40px",height:"25px"},pos:{x:50,y:200},zIndex:1},13376:{id:"13376",type:"label",name:"Model",size:{width:"50px",height:"25px"},pos:{x:50,y:300},zIndex:1},13372:{id:"13372",type:"textbox",size:{width:"80px",height:"25px"},pos:{x:100,y:200},zIndex:2},13373:{id:"13373",type:"textbox",size:{width:"80px",height:"25px"},pos:{x:100,y:300},zIndex:2},13374:{id:"13374",type:"image",fit:"cover",size:{width:"300px",height:"150px"},pos:{x:50,y:400},zIndex:2}}},setSize:function(e,t){-1!==f&&(this[f].layout[e].size=t)},setPos:function(e,t){-1!==f&&(this[f].layout[e].pos=t)},editTemplateElementName:function(e,t){this[f].layout[e].name=t,"templateName"===this[f].layout[e].type&&(this[f].name=t)},setImageFitType:function(e,t){this[f].layout[e].fit=t}},{setSize:l.f,setPos:l.f,editTemplateElementName:l.f,setImageFitType:l.f}),m=Object(l.m)({1337:{111:{id:"111",parentID:"1337",name:"Ford",nameChained:"13372",fill:{13372:{id:"13372",content:"Ford"},13373:{id:"13373",content:"Mustang"},13374:{id:"13374",content:"https://autoua.net/media/uploads/ford/electric-ford-mustang-by-charge-cars.jpg"}}},222:{id:"222",parentID:"1337",name:"Toyota",nameChained:"13372",fill:{13372:{id:"13372",content:"Toyota"},13373:{id:"13373",content:"Corolla"},13374:{id:"13374",content:"https://carrentalgeorgia.ge/uploads/product/834471572870733.jpg"}}}},editRecordField:function(e,t){this[f.get()][g.get()].fill[e].content=t,this[f.get()][g.get()].nameChained===e&&(this[f.get()][g.get()].name=t)}},{editRecordField:l.f}),f=l.m.box(-1),g=l.m.box(-1),b=function(){return Object(l.p)(h[f.get()])},y=function(){return Object(l.p)(m[f.get()][g.get()])},v=function(e){f.set(e)},x=function(){var e=f.get(),t=u(),n=b();m[e]||(m[e]={});var a={};Object.values(n.layout).forEach((function(e){"templateName"!==e.type&&"label"!==e.type&&(a[e.id]={id:e.id,content:"new textbox"})}));m[e][t]={id:t,parentID:e,name:"new record to parent "+n.name,nameChained:function(){var e=Object.values(n.layout);if(e.length<1)return-1;var t=e.filter((function(e){return"textbox"===e.type}));return t.length<1?-1:t[0].id}(),fill:a}},w=function(e,t){h.setPos(e,t)},k=function(e,t,n){m.editRecordField(e,t,n)},E=function(e){return b().layout[e]},j=n(2),O=n.n(j),C=n(5),z=n(18),I=n(19),N=n(8),S=n.n(N),R=(n(31),n(34),{apiKey:"AIzaSyCOXPIqPDh8rFIfui0Fa59e10pct7UteJY",authDomain:"classified-archive.firebaseapp.com",databaseURL:"https://classified-archive.firebaseio.com",projectId:"classified-archive",storageBucket:"classified-archive.appspot.com",messagingSenderId:"468475443076",appId:"1:468475443076:web:231c9e1842004f7af98fd1"}),A=new(function(){function e(){Object(z.a)(this,e),S.a.initializeApp(R),this.auth=S.a.auth(),this.db=S.a.firestore()}return Object(I.a)(e,[{key:"updateUserProfileName",value:function(){var e=Object(C.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.auth.currentUser;try{n.updateProfile({displayName:t})}catch(a){alert("Can't update user profile name"),console.log(a)}case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithEmailAndPassword",value:function(){var e=Object(C.a)(O.a.mark((function e(t,n,a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(!0),e.next=4,this.auth.signInWithEmailAndPassword(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),a(!1),console.log(e.t0),e.abrupt("return",e.t0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"signInWithPopup",value:function(){var e=Object(C.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new this.auth.GoogleAuthProvider,e.prev=1,e.next=4,this.auth().signInWithPopup(t);case 4:n=e.sent,n.credential.accessToken,n.user,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),alert("Can't sign in with popup"),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Object(C.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.auth.signOut();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Sign out error"),console.log(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"createUserWithEmailAndPassword",value:function(){var e=Object(C.a)(O.a.mark((function e(t,n,a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(!0),e.next=4,this.auth.createUserWithEmailAndPassword(t,n);case 4:return e.next=6,this.db.collection("users").doc(this.auth.currentUser.uid).set({products:[],sells:[],pastSells:[]});case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),a(!1),e.abrupt("return",e.t0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"updateCollection",value:function(){var e=Object(C.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.collection("users").doc(this.auth.currentUser.uid).get();case 3:t=e.sent,this.collection=t.data(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Can't get data from database"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"addData",value:function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.collection("users").doc(this.auth.currentUser.uid).update({products:S.a.firestore.FieldValue.arrayUnion(t)});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Can't add data"),console.log(e.t0);case 9:return e.next=11,this.updateCollection();case 11:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteData",value:function(){var e=Object(C.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.collection("users").doc(this.auth.currentUser.uid).update({products:S.a.firestore.FieldValue.arrayRemove(t)});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Can't delete data"),console.log(e.t0);case 9:return e.next=11,this.updateCollection();case 11:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()),D=n(6),P=Object(c.b)("templates","records")(Object(c.c)((function(e){var t=e.templates,n=e.records,i=Object(a.useState)(-1),o=Object(D.a)(i,2),c=o[0],l=o[1];Object(a.useEffect)((function(){var e=f.get();-1!==e?l(e):(e=Object.keys(t)[0])&&(l(e),v(e))}),[t]);var s=function(){var e=Object(C.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.signOut();case 2:p("login");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("button",{onClick:s},"Logout"),-1===c?r.a.createElement("div",null,"No templates found"):r.a.createElement("div",null,r.a.createElement("select",{onChange:function(e){l(e.target.value),v(e.target.value)},value:c},Object.keys(t).map((function(e){return r.a.createElement("option",{key:e,value:e},t[e].name)}))),r.a.createElement("button",{onClick:function(){p("editTemplate")}},"Edit template"),r.a.createElement("button",{onClick:function(){var e=function(){var e=u();return h[e]={id:e,name:"New template",layout:{1:{id:"1",type:"templateName",name:"New template",size:{width:"100px",height:"25px"},pos:{x:200,y:50},zIndex:1},2:{id:"2",type:"label",name:"default label",size:{width:"90px",height:"25px"},pos:{x:50,y:100},zIndex:1},3:{id:"3",type:"textbox",size:{width:"100px",height:"25px"},pos:{x:150,y:100},zIndex:1}}},v(e),x(),e}();l(e)}},"Create new template"),r.a.createElement("button",{onClick:x},"Add record"),n[c]?Object.keys(n[c]).map((function(e){return r.a.createElement("div",{style:{paddingTop:"20px"},key:e,onClick:function(){var t;t=e,g.set(t),p("showRecord")}},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-around",padding:"10px",cursor:"pointer",border:"1px solid green",marginBottom:"10px",backgroundColor:"rgba(100, 255, 150, 0.2)"}},n[c][e].name))})):r.a.createElement("p",null,"No records found")))}))),L=n(7),T=function(e){var t=e.layoutId,n=e.content,a=b().layout[t];return r.a.createElement(L.a,{size:a.size,position:a.pos,style:{display:"flex",alignItems:"center",justifyContent:"center"},disableDragging:!0,enableResizing:{bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1}},function(){switch(a.type){case"textbox":return r.a.createElement("p",null,n);case"templateName":return r.a.createElement("p",null,a.name);case"label":return r.a.createElement("p",null,a.name,":");case"image":return r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundImage:"url(".concat(n,")"),backgroundPosition:"center",backgroundSize:a.fit,backgroundRepeat:"no-repeat",border:"1px solid black"}})}}())},F=Object(c.b)("templates")(Object(c.c)((function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){p("list")}},"Back"),r.a.createElement("button",{onClick:function(){p("editRecord")}},"Edit record"),Object.keys(b().layout).map((function(e){var t=function(e){var t=!1,n=y().fill[e];return n&&(t=n.content),t}(e);return r.a.createElement(T,{key:e,layoutId:e,content:t})})))}))),U=Object(c.b)("templates")(Object(c.c)((function(e){var t=e.layoutId,n=e.active,a=e.setActiveHandle,i=b().layout[t];return r.a.createElement(L.a,{size:i.size,position:i.pos,onDragStop:function(e,t){return-1!==n&&w(i.id,t)},onResizeStop:function(e,t,a,r,o){return-1!==n&&function(e,t,n){var a={width:n.style.width,height:n.style.height};h.setSize(e,a),w(e,t)}(i.id,o,a)},onMouseDown:function(e){return a(e,i.id)},onResize:function(e){return a(e,i.id)},bounds:".dragBoxBoundry",style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{pointerEvents:"none",position:"absolute",display:"inline",width:"100%",height:"100%",top:"0",left:"0",bottom:"0",right:"0",border:n===i.id?"1px solid rgb(193, 66, 66)":"1px solid rgb(122, 122, 122)",backgroundColor:n===i.id?"rgba(193, 66, 66, 0.26)":"rgba(122, 122, 122, 0.26)"}}),function(){switch(i.type){case"textbox":return r.a.createElement("textarea",{style:{margin:"0",padding:"0",width:"100%",height:"100%",border:"none",outline:"none",color:"grey",resize:"none",textAlignLast:"center",backgroundColor:"transparent"},readOnly:!0,value:"Textbox"});case"label":case"templateName":return r.a.createElement("textarea",{style:{margin:"0",padding:"0",width:i.size.width,height:i.size.height,textAlignLast:"center",border:"none",outline:"none",color:"black",resize:"none",backgroundColor:"transparent"},value:i.name,onChange:function(e){return n=t,a=e.target.value,void h.editTemplateElementName(n,a);var n,a},onDoubleClick:function(e){return e.target.select()}});case"image":return r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundImage:"url(https://static.toiimg.com/thumb/72975551.cms?width=680&height=512&imgsize=881753)",backgroundPosition:"center",backgroundSize:i.fit,backgroundRepeat:"no-repeat",border:"1px solid black"}})}}())}))),W=function(e){var t=e.layoutItemID,n=e.setActive,a=e.styleSheet,i=function(){var e=!0;"textbox"===E(t).type&&(e=window.confirm("This will delete all connected record fields")),e&&(!function(e){var t=f.get();delete h[t].layout[e],Object.keys(m[t]).map((function(n){Object.keys(m[t][n].fill).map((function(a){a===e&&delete m[t][n].fill[a]}))}))}(t),n(-1))},o=function(e){!function(e,t){"image"===b().layout[e].type?h.setImageFitType(e,t):console.log("Trying to change fit type for non-image layout element!")}(t,e.target.value)};return r.a.createElement("div",{style:a},-1===t?r.a.createElement("p",null,"No layout item chosen"):function(){var e=E(t);return r.a.createElement("div",null,r.a.createElement("p",null,e.type),"templateName"!==e.type&&r.a.createElement("button",{onClick:i},"Delete this shit"),"image"===e.type&&function(e){return r.a.createElement("select",{onChange:o,value:e.fit},s.map((function(e){return r.a.createElement("option",{key:e,value:e},e)})))}(e))}())},B=function(e){var t=e.styleSheet,n=e.setActive,i=["label","textbox","image"],o=Object(a.useState)({}),c=Object(D.a)(o,2),l=c[0],s=c[1];return Object(a.useEffect)((function(){var e={};i.forEach((function(t,n){return e[t]={x:"",y:50*n+10*(n+1)}})),s(e)}),[]),r.a.createElement("div",{style:t},Object.keys(l).map((function(e){return r.a.createElement(L.a,{key:e,position:l[e],size:{width:"100%",height:50},enableResizing:!1,onDragStop:function(t,a){if(!(a.x>=0)){var r={x:t.target.parentNode.parentNode.clientWidth+a.x-t.target.parentNode.clientWidth,y:a.y},i=function(e,t){var n=f.get(),a=u(),r={id:a,type:e,name:"New "+e,size:{width:"80px",height:"25px"},pos:t,zIndex:1};if("image"===e&&(r.size.width="300px",r.size.height="150px",r.fit="cover"),h[n].layout[a]=r,"templateName"===e||"label"===e)return a;var i=f.get();return Object.keys(m).forEach((function(t){t===i&&Object.keys(m[t]).forEach((function(n){m[t][n].fill[a]={id:a,content:"New "+e}}))})),a}(e,r);n(i)}},style:{display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid blue"}},e)})))},M=Object(c.b)("templates")(Object(c.c)((function(){var e=Object(a.useState)(-1),t=Object(D.a)(e,2),n=t[0],i=t[1],o=function(e,t){n!==t&&(e.stopPropagation(),i(t))};return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100vh",width:"100vw"}},r.a.createElement("div",{style:{display:"flex",height:"85vh",width:"100vw"}},r.a.createElement("div",{className:"dragBoxBoundry",style:{border:"1px solid cyan",width:"85vw",height:"inherit",backgroundColor:"rgba(100, 150, 255, 0.2)"}},r.a.createElement("button",{onClick:function(){return p("list")}},"Go to List"),Object.keys(b().layout).map((function(e){return r.a.createElement(U,{key:e,layoutId:e,active:n,setActiveHandle:o})}))),r.a.createElement(B,{setActive:i,styleSheet:{width:"15vw",height:"inherit",backgroundColor:"rgba(100, 255, 100, 0.2)",border:"1px solid green",position:"fixed",right:"0",top:"0",display:"flex",flexDirection:"column",alignItems:"center"}})),r.a.createElement(W,{layoutItemID:n,setActive:i,styleSheet:{height:"15vh",width:"100vw",backgroundColor:"rgba(255, 100, 100, 0.2)",border:"1px solid red",position:"fixed",bottom:"0"}}))}))),G=n(22),J=Object(c.b)("records")(Object(c.c)((function(e){var t=e.fillItemId,n=e.content,a=b().layout[t];return r.a.createElement(L.a,{size:a.size,position:a.pos,disableDragging:!0,enableResizing:{bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{pointerEvents:"none",position:"absolute",display:"inline",width:"100%",height:"100%",top:"0",left:"0",bottom:"0",right:"0"}}),function(){switch(a.type){case"textbox":return r.a.createElement("textarea",{style:{margin:"0",padding:"0",width:"100%",height:"100%",border:"none",outline:"none",color:"black",backgroundColor:"rgba(0, 0, 0, 0.1)",resize:"none",textAlignLast:"center"},value:n,onChange:function(e){return k(t,e.target.value)},onDoubleClick:function(e){return e.target.select()}});case"templateName":case"label":return r.a.createElement("textarea",{style:{margin:"0",padding:"0",width:a.size.width,height:a.size.height,textAlignLast:"center",border:"none",outline:"none",color:"grey",backgroundColor:"rgba(0, 0, 0, 0.1)",resize:"none",pointerEvents:"none"},value:a.name,readOnly:!0});case"image":return r.a.createElement("div",{style:{display:"flex",margin:"0",padding:"0",width:a.size.width,height:a.size.height,alignItems:"center",backgroundImage:"url(".concat(n,")"),backgroundPosition:"center",backgroundSize:a.fit,backgroundRepeat:"no-repeat",border:"1px solid black"}},r.a.createElement("input",{style:Object(G.a)({width:a.size.width,border:"none",outline:"none",background:"rgba(230, 230, 230, 0.9)"},"border","1px solid black"),value:n,onChange:function(e){return k(t,e.target.value)},onDoubleClick:function(e){return e.target.select()}}))}}())}))),H=Object(c.b)("records")(Object(c.c)((function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return p("showRecord")}},"Back"),r.a.createElement("button",{onClick:function(){return p("list")}},"Go to List"),Object.keys(b().layout).map((function(e){var t=function(e){var t,n=y().fill[e];return n&&(t=n.content),t}(e);return r.a.createElement(J,{key:e,fillItemId:e,content:t})})))}))),V=function(){var e=Object(a.useState)(""),t=Object(D.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(""),c=Object(D.a)(o,2),l=c[0],u=c[1],s=Object(a.useState)(!1),d=Object(D.a)(s,2),h=d[0],m=d[1],f=function(){var e=Object(C.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.signInWithEmailAndPassword(n,l,m);case 2:(t=e.sent)?alert(t.message):p("list");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(C.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.createUserWithEmailAndPassword(n,l,m);case 2:(t=e.sent)?alert(t.message):p("list");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h1",null,"Login or register"),r.a.createElement("form",{onSubmit:function(e){return e.preventDefault()&&!1}},r.a.createElement("label",null,"Email Address"),r.a.createElement("input",{id:"email",name:"email",value:n,onChange:function(e){return i(e.target.value)}}),r.a.createElement("label",null,"Password"),r.a.createElement("input",{name:"password",type:"password",id:"password",value:l,onChange:function(e){return u(e.target.value)}}),r.a.createElement("button",{onClick:f},"Sign in"),r.a.createElement("button",{onClick:g},"Register")),h&&r.a.createElement("div",{className:"loader"},"Loading"))},q=Object(c.b)("screen")(Object(c.c)((function(e){var t=e.screen,n=function(){var e=Object(C.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A.auth.onAuthStateChanged((function(e){e?(A.updateCollection(),p("list")):p("login")}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){n()}),[]);return r.a.createElement("div",null,function(){switch(t.get()){case"loading":return r.a.createElement("div",{className:"loader"},"Loading");case"login":return r.a.createElement(V,null);case"list":return r.a.createElement(P,null);case"showRecord":return r.a.createElement(F,null);case"editTemplate":return r.a.createElement(M,null);case"editRecord":return r.a.createElement(H,null);default:return alert("Router error"),r.a.createElement(P,null)}}())}))),K=function(){return r.a.createElement(c.a,{templates:h,records:m,screen:d},r.a.createElement(q,null))};o.a.render(r.a.createElement(K,null),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.4a6f0fd9.chunk.js.map